---
lab:
  title: استكشاف تصنيف الصور
---

# <a name="explore-image-classification"></a>استكشاف تصنيف الصور

> **ملاحظة** لإكمال هذا النشاط المعملي، ستحتاج إلى [اشتراك Azure](https://azure.microsoft.com/free?azure-portal=true) الذي لديك فيه حق الوصول الإداري.

توفر الخدمة المعرفية *Computer Vision* نماذج مفيدة مسبقة الصنع للعمل مع الصور، ولكنك ستحتاج غالبًا إلى تدريب نموذجك الخاص على رؤية الكمبيوتر. على سبيل المثال، افترض أن شركة البيع بالتجزئة Northwind Traders تريد إنشاء نظام سداد آلي يحدد عناصر البقالة التي يرغب العملاء في شرائها استنادًا إلى صورة التقطتها الكاميرا عند الخروج. للقيام بذلك، سوف تحتاج إلى تدريب نموذج تصنيف يمكنه تصنيف الصور لتحديد العنصر الذي يتم شراؤه.

في Azure، يمكنك استخدام الخدمة المعرفية *** Custom Vision *** لتدريب نموذج تصنيف الصورة بناءً على الصور الموجودة. يوجد عنصران لإنشاء حل تصنيف الصور. أولاً، يجب تدريب نموذج للتعرف على الفئات المختلفة باستخدام الصور الموجودة. بعد ذلك، عندما يتم تدريب النموذج، يجب عليك نشره كخدمة يمكن أن تستهلكها التطبيقات.

لاختبار قدرات خدمة Custom Vision، سنستخدم تطبيق سطر أوامر بسيطًا يتم تشغيله في Cloud Shell. تنطبق نفس المبادئ والوظائف في حلول العالم الحقيقي، مثل مواقع الويب أو تطبيقات الهاتف.

## <a name="create-a-cognitive-services-resource"></a>إنشاء مورد *الخدمات المعرفية*

يمكنك استخدام خدمة Custom Vision بإنشاء إما مورد **رؤية مخصصة** أو مورد ** الخدمات المعرفية**.

>**ملاحظة** لا يتوفر كل مورد في كل منطقة. سواء قمت بإنشاء مورد Custom Vision أو Cognitive Services، فلا يمكن استخدام سوى الموارد التي تم إنشاؤها في [مناطق معينة](https://azure.microsoft.com/global-infrastructure/services/?products=cognitive-services) للوصول إلى خدمات Custom Vision. من أجل البساطة، يتم تحديد المنطقة مسبقاً لك في إرشادات التكوين أدناه.

أنشئ مورد **Cognitive Services** في اشتراكك في Azure.

1. في علامة تبويب مستعرض أخرى، افتح مدخل Azure في [https://portal.azure.com](https://portal.azure.com?azure-portal=true)، وقم بتسجيل الدخول باستخدام حساب Microsoft الخاص بك.

1. انقر فوق **&#65291;إنشاء** زر مورد والبحث عن *الخدمات المعرفية* وإنشاء مورد الخدمات **المعرفية ** مع الإعدادات التالية:
    - **الاشتراك**: *اشتراك Azure الخاص بك*.
    - **مجموعة الموارد**: *أنشئ مجموعة موارد جديدة ذات اسم فريد*.
    - **المنطقة**: شرق الولايات المتحدة
    - **الاسم**: *أدخل اسمًا مميزًا*.
    - **مستوى التسعير**: قياسي S0
    - **By checking this box I acknowledge that I have read and understood all the terms below**: محدد.

1. راجع المورد وأنشئه، وانتظر حتى يكتمل التوزيع. ثم انتقل إلى المورد الموزع.

1. عرض صفحة **Keys and Endpoint** لمورد الخدمات المعرفية. ستحتاج نقطة النهاية والمفاتيح للاتصال من تطبيقات العميل.

## <a name="create-a-custom-vision-project"></a>إنشاء مشروع Custom Vision

لتدريب نموذج اكتشاف العنصر، تحتاج إلى إنشاء مشروع رؤية مخصصة بناءً على مورد التدريب الخاص بك. للقيام بذلك، ستستخدم مدخل Custom Vision.

1. قم بتنزيل واستخراج صور التدريب منhttps://aka.ms/fruit-images. يتم توفير هذه الصور في مجلد مضغوط، والذي يحتوي عند استخراجه على مجلدات فرعية تسمى **تفاح** و **موز** و **برتقال**.

1. في علامة تبويب متصفح أخرى، افتح مدخل Custom Vision على [https://customvision.ai](https://customvision.ai?azure-portal=true). إذا طُلب منك ذلك، قم بتسجيل الدخول باستخدام حساب Microsoft المرتبط باشتراك Azure الخاص بك ووافق على شروط الخدمة.

1. في مدخل Custom Vision، أنشئ مشروعًا جديدًا بالإعدادات التالية:

    - **الاسم**: البقالة السداد مع الخروج
    - **الوصف**: تصنيف الصور لمحلات بقالة
    - **المورد**: * مورد Custom Vision الذي أنشأته مسبقًا*
    - **أنواع المشاريع**: التصنيف
    - **Classification Types**: متعدد الفئات (علامة واحدة لكل صورة)
    - **المَجالات**: الغذاء

1. انقر فوق **Add images**، وحدد جميع الملفات الموجودة في مجلد **apple** الذي قمت باستخراجه مسبقًا. ثم قم بتحميل ملفات الصور، مع تحديد العلامة *تفاحة*، على النحو التالي:

    ![تحميل التفاح مع علامة التفاح](media/create-image-classification-system/upload-apples.jpg)

1. كرر الخطوة السابقة لتحميل الصور في مجلد **الموز** مع *الموز*العلامة، والصور في المجلد **البرتقالي** مع علامة *البرتقالي*.

1. استكشف الصور التي قمت بتحميلها في مشروع Custom Vision - يجب أن يكون هناك 15 صورة لكل فصل، على النحو التالي:

    ![صور مميزة للفاكهة - 15 تفاحة و 15 موزة و 15 برتقالة](media/create-image-classification-system/fruit.jpg)

1. في مشروع Custom Vision، فوق الصور، انقر فوق **"تدريب"** لتدريب نموذج تصنيف باستخدام الصور ذات العلامات. حدد خيار **"تدريب سريع"**، ثم انتظر حتى يكتمل تكرار التدريب (قد يستغرق ذلك دقيقة أو نحو ذلك).

1. عند تدريب تكرار النموذج، راجع مقاييس الأداء *الدقة**والاستدعاء*و*AP* - تقيس هذه دقة التنبؤ لنموذج التصنيف، ويجب أن تكون جميعها عالية.

## <a name="test-the-model"></a>اختبار النموذج

قبل نشر هذا التكرار للنموذج لتستخدمه التطبيقات، يجب عليك اختباره.

1. فوق مقاييس الأداء، انقر فوق **اختبار سريع**.

1. في المربع **URL للصورة،** اكتب `https://aka.ms/apple-image` وانقر فَوق &#10132;

1. اعرض التوقعات التي يعرضها نموذجك - يجب أن تكون درجة احتمالية *تفاحة* أعلى، كما يلي:

    ![صورة مَع التنبؤ الطبقي بالتفاح](media/create-image-classification-system/test-apple.jpg)

1. أغلق نافذة **اختبار سريع**.

## <a name="publish-the-image-classification-model"></a>نَشر نموذج تصنيف الصور

أنت الآن جاهز لنشر نموذجك المدرّب واستخدامه من تطبيق عميل.

1. انقر فوق **&#128504; انشر** لنشر النموذج المدربين مع الإعدادات التالية:
    - **اسم النموذج**: البقالة
    - **مورد التنبؤ**: * مورد التنبؤ الذي أنشأته مسبقًا*.

1. بعد النشر، انقر فوق *"عنوان URL للتنبؤ"* (&#127760;) لرؤية المعلومات المطلوبة لاستخدام النموذج المنشور. لاحقًا، ستحتاج إلى عنوان URL المناسب وقيم مفتاح التنبؤ للحصول على تنبؤ من عنوان URL للصورة، لذلك احتفظ بمربع الحوار هذا مفتوحًا وتابع إلى المهمة التالية. 

## <a name="run-cloud-shell"></a>تشغيل Cloud Shell

لاختبار قدرات خدمة «الرؤية المخصصة»، سنستخدم تطبيق سطر أوامر بسيط يعمل في Cloud Shell على Azure.

1. في مدخل Azure، حدد زر **[>_]** *(Cloud Shell)* أعلى الصفحة يمين مربع البحث. يؤدي ذلك إلى فتح جزء Cloud Shell في أسفل المدخل. 

    ![بدء تشغيل Cloud Shell بالنقر على الرمز الموجود على يمين مربع البحث العلوي](media/create-image-classification-system/powershell-portal-guide-1.png)

1. في المرة الأولى التي تفتح فيها Cloud Shell، قد يُطلب منك اختيار نوع shell التي تريد استخدامها (*Bash* أو *PowerShell).* حدد **PowerShell**. إذا لم ترى هذا الخيار، تخطي الخطوة.  

1. إذا تمت مطالبتك بإنشاء سعة تخزينية لشركة Cloud Shell، فتأكد من تحديد اشتراكك وحدد **Create storage**. ثم انتظر دقيقة أو نحو ذلك لإنشاء التخزين.

    [![أنشئ التخزين بالنقر فوق «confirm».](media/create-image-classification-system/powershell-portal-guide-2.png)](media/create-image-classification-system/powershell-portal-guide-2.png#lightbox)

1. تأكد من تبديل نوع shell المشار إليه في أعلى يسار جزء Cloud Shell إلى *PowerShell*. إذا كان *Bash*، فقم بالتبديل إلى *PowerShell* باستخدام القائمة المنسدلة.

    ![كيفية العثور على القائمة المنسدلة ناحية اليسار للتبديل إلى PowerShell](media/create-image-classification-system/powershell-portal-guide-3.png)

1. انتظر حتى يبدأ PowerShell. يجب أن ترى الشاشة التالية في مدخل Azure:  

    ![انتظر حتى يبدأ PowerShell.](media/create-image-classification-system/powershell-prompt.png)

## <a name="configure-and-run-a-client-application"></a>كوّن تطبيق عميل وقم بتشغيله

الآن بعد أن أصبح لديك بيئة Cloud Shell، يمكنك تشغيل تطبيق بسيط يستخدم خدمة Custom Vision لتحليل صورة.

1. في shell الأمر، أدخل الأمر التالي لتحميل نموذج التطبيق وحفظه إلى مجلد يسمى «ai-900». 

    ```PowerShell
    git clone https://github.com/MicrosoftLearning/AI-900-AIFundamentals ai-900
    ```

    >**تلميح** إذا كنت قد استخدمت هذا الأمر بالفعل في نشاط معملي آخر لاستنساخ مستودع *ai-900*، فيمكنك تخطي هذه الخطوة.

1. يتم تحميل الملفات إلى مجلد يسمى **ai-900** نريد الآن رؤية جميع الملفات في تخزين Cloud Shell الخاص بك والعمل معهم. اكتب الأمر التالي في shell:

    ```PowerShell
    code .
    ```

    لاحظ كيف يفتح هذا محررًا مثل المحرر الموجود في الصورة أدناه: 

    ![محرر التعليمات البرمجية.](media/create-image-classification-system/powershell-portal-guide-4.png)

1. في جزء **الملفات** على اليسار، وسّع ** ai-900 ** وحدد **classify-image.ps1**. يحتوي هذا الملف على بعض التعليمات البرمجية التي تستخدم نموذج الرؤية المخصصة لتحليل صورة، كما هو موضح هنا:

     ![المحرر الذي يحتوي على رمز لتصنيف الصورة](media/create-image-classification-system/classify-image-code.png)

1. لا تقلق كثيرًا بشأن تفاصيل التعليمة البرمجية، فالشيء المهم هو أنه يحتاج إلى عنوان URL للتنبؤ ومفتاح نموذج الرؤية المخصصة عند استخدام عنوان URL للصورة. 

   احصل على *عنوان URL للتوقع* من مربع الحوار في مشروع Custom Vision الخاص بك. 

   >**ملاحظة** تذكر أنك راجعت *عنوان URL للتوقع* بعد نشر نموذج تصنيف الصور. للعثور على *عنوان URL للتوقع*، انتقل إلى علامة تبويب **الأداء** في مشروعك، ثم انقر فوق **عنوان URL للتوقع** (إذا كانت الشاشة مضغوطة، فقد ترى رمز الكرة الأرضية). سيظهر مربع حوار. انسخ عنوان URL لـ **إذا كان لديك عنوان URL للصورة**. الصقه في محرر التعليمة البرمجية، مع استبدال **YOUR_PREDICTION_URL**.

    باستخدام نفس مربع الحوار، احصل على *مفتاح التنبؤ*. انسخ مفتاح التنبؤ المعروض بعد *تعيين عنوان مفتاح التنبؤ على*. الصقها في محرر التعليمات البرمجية، مع استبدال قيمة العنصر النائب **YOUR_PREDICTION_KEY**.

    ![لقطة شاشة لعنوان URL للتوقع.](media/create-image-classification-system/find-prediction-url.png)

    بعد لصق قيم عنوان URL للتنبؤ ومفتاح التنبؤ، يجب أن يتشابه أول سطرين من التعليمات البرمجية مع هذا:

    ```PowerShell
    $predictionUrl="https..."
    $predictionKey ="1a2b3c4d5e6f7g8h9i0j...."
    ```

1. في أعلى يمين جزء المحرر، استخدم الزر **...** لفتح القائمة ثم حدد **Save** لحفظ التغييرات. ثم افتح القائمة مرة أخرى وحدد **Close Editor**.

    ستستخدم نموذج تطبيق العميل لتصنيف عدة صور في فئة التفاح أو الموز أو البرتقال.

1. سَنقوم بتصنيف هذه الصورة:

    ![صورة لتفاحة](media/create-image-classification-system/fruit-1.jpg)

    أدخل الأمر التالي في جزء PowerShell لتشغيل التعليمات البرمجية:

    ```PowerShell
    cd ai-900
    ./classify-image.ps1 1
    ```

1. راجع التوقع، والذي يجب أن يكون **تفاحة**.

1. الآن دعونا نجرب صورة أخرى:

    ![صورة موزة](media/create-image-classification-system/fruit-2.jpg)

    شغَّل هذا الأمر:

    ```PowerShell
    ./classify-image.ps1 2
    ```

1. تحقق من أن النموذج يصنف هذه الصورة على أنها **موزة**.

1. أخيرًا، لنجرب صورة الاختبار الثالثة:

    ![صورة برتقالة](media/create-image-classification-system/fruit-3.jpg)

    شغَّل هذا الأمر:

    ```PowerShell
    ./classify-image.ps1 3
    ```

1. تحقق من أن النموذج يصنف هذه الصورة على أنها **برتقالة**.

## <a name="learn-more"></a>معرفة المزيد

يعرض هذا التطبيق البسيط بعض إمكانيات خدمة Custom Vision فقط. لمعرفة المزيد حول ما يمكنك القيام به بهذه الخدمة، راجع [صفحة الرؤية المخصصة](https://azure.microsoft.com/services/cognitive-services/custom-vision-service/).
